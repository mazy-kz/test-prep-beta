import { NextResponse } from 'next/server'; import { createSession } from '@/lib/auth';
export async function POST(req: Request){ const body=await req.json(); const email=(body?.email||'').toString(); const password=(body?.password||'').toString(); const ADMIN_EMAIL=process.env.ADMIN_EMAIL||'admin@example.com'; const ADMIN_PASSWORD=process.env.ADMIN_PASSWORD||'admin123'; if(email!==ADMIN_EMAIL||password!==ADMIN_PASSWORD){ return NextResponse.json({error:'Invalid credentials'},{status:401}); } const token=createSession(email); const res=NextResponse.json({ok:true}); res.cookies.set('admin_session',token,{httpOnly:true,sameSite:'lax',path:'/'}); return res; }
